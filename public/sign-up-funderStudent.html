<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta tags for character encoding and responsive viewport -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Sign Up</title>

  <!-- External CSS libraries -->
  <!-- Bootstrap CSS for responsive design and components -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <!-- Bootstrap Icons for additional icon set -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Custom global stylesheet -->
  <link rel="stylesheet" href="./css/styles.css">

  <!-- Page-specific inline styles for signup page -->
<style>
/* Dashboard header styling */
.dashboard-header {
  background-color: #2A6F97;
  padding: 30px 0;
  margin-bottom: 0px;
}

/* Heading color styling */
.funder-heading {
  color: #012A4A;
}

.dashboard-header {
  color: #012A4A;
}

/* Utility class to hide elements */
.hidden { 
  display: none; 
}

/* Form section spacing */
.form-section { 
  margin-top: 20px; 
}

/* Profile card background color */
.profile-card {
  background-color: #A9D6E5;
}

/* Submit button styling */
.btn-submit-sign-up {
  background-color: #012A4A;
  color: #A9D6E5;
  font-weight: 800;
  box-shadow: 0 4px 12px rgba(55, 44, 161, 0.2);
  transition: all 0.3s ease;
}

/* Submit button hover effects */
.btn-submit-sign-up:hover {
  color: #012A4A;
  background-color: #ffd60a;
  transform: scale(1.02);
}

/* Form label styling */
.form-label {
  font-size: small;
  font-weight: bold;
}

/* Toggle switch container styling */
.toggle-switch {
  position: relative;
  width: 220px;
  height: 50px;
  background-color: #012a4a2e;
  border-radius: 25px;
  display: flex;
  cursor: pointer;
  user-select: none;
}

/* Individual toggle option styling */
.toggle-option {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2;
  font-weight: bold;
  color: #0B93FB;
  transition: color 0.3s;
}

/* Active toggle option styling */
.toggle-option.active {
  color: #fff;
}

/* Moving indicator for toggle switch */
.toggle-indicator {
  position: absolute;
  top: 2px;
  left: 50%;
  width: 108px;
  height: 46px;
  background-color: #012A4A;
  border-radius: 25px;
  transition: left 0.3s;
  z-index: 1;
}

</style>

<!-- Firebase authentication and database import -->
<script type="module">
  import { auth, db } from './firebase-config.js';
</script>

</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-custom px-3">
  <div class="container-fluid">
    <!-- Brand/logo linking to homepage -->
    <a class="navbar-brand ms-2" href="index.html">FundMyFuture</a>

    <!-- Mobile menu toggle button that triggers offcanvas -->
    <button class="navbar-toggler text-white" type="button" data-bs-toggle="offcanvas" data-bs-target="#navbarOffcanvas">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Offcanvas menu for mobile navigation -->
    <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="navbarOffcanvas">
      <div class="offcanvas-header">
        <!-- Close button for offcanvas -->
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <!-- Navigation links -->
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item me-3">
            <!-- Donate button -->
            <a class="btn donate-btn ms-2" href="donate.html">DONATE NOW</a>
          </li>
          <li class="nav-item">
            <!-- Students section link -->
            <a class="nav-link" href="sign-up-funderStudent.html">STUDENTS</a>
          </li>
          <li class="nav-item">
            <!-- Funders section link -->
            <a class="nav-link" href="sign-up-funderStudent.html">FUNDERS</a>
          </li>
          <li class="nav-item">
            <!-- About us page link -->
            <a class="nav-link" href="about.html">ABOUT US</a>
          </li>
          <li class="nav-item me-2" id="login-area">
            <!-- Login button -->
            <a class="btn login-btn fw-bolder" href="login.html">LOGIN</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</nav>


<!-- Dashboard Header Section -->
<div class="container-fluid dashboard-header">
  <div class="d-flex flex-wrap align-items-center">
    <!-- Image Column -->
    <div class="flex-shrink-0 ms-4 me-3 mb-3 mb-md-0">
      <img src="./assets/happy students.png" class="img-fluid" alt="Funder Icon">
    </div>

    <!-- Text Column -->
    <div class="flex-grow-1 text-start">
      <h4 class="fw-bold funder-heading mb-0">Welcome to</h4>
      <h2 class="fw-bold dashboard-heading">FundMyFuture</h2>
    </div>
  </div>
</div>

<!-- Sign Up Page Content -->
<div class="container mt-5">
  <!-- Page heading -->
  <h2 class="text-center mb-2">Sign Up</h2>
  <h6 class="text-center text-muted fw-light mb-4">
    Please fill in the following information to continue:
  </h6>

  <!-- User Type Toggle Switch -->
  <div class="toggle-wrapper mb-4 d-flex justify-content-center">
    <div class="toggle-switch" id="toggleSwitch">
      <div class="toggle-option student">Student</div>
      <div class="toggle-option funder">Funder</div>
      <div class="toggle-indicator" id="toggleIndicator"></div>
    </div>
    <!-- Hidden input to store selected user type -->
    <input type="hidden" id="userType" />
  </div>



  <!-- All Form Sections (hidden initially until user type is selected) -->
  <div id="signupFormSections" class="hidden">
    <!-- Profile Section - Common fields for both user types -->
    <div id="profileSection" class="profile-card container mt-4 p-4 rounded">
      <!-- Profile Picture Upload -->
      <div class="row align-items-center mb-4">
        <div class="col-md-2 text-center">
          <img src="./assets/profile-user.png" alt="Profile Picture" class="img-fluid mb-3 w-100" style="max-width: 200px;"/>
          <input type="file" class="form-control form-control-sm mb-3" />
        </div>
        <!-- Name Fields -->
        <div class="col-md-5">
          <div class="row">
            <div class="col-md-12 mb-3">
              <label for="firstName" class="form-label">First Name *</label>
              <input type="text" class="form-control" placeholder="First Name" id="firstName" required/>
            </div>
            <div class="col-md-12 mb-3">
              <label for="surName" class="form-label">Surname *</label>
              <input type="text" class="form-control" placeholder="Surname" id="surName" required/>
            </div>
          </div>
        </div>
        <!-- ID & Date of Birth Fields -->
        <div class="col-md-5">
          <div class="row">
            <div class="col-md-12 mb-3">
              <label for="idNumber" class="form-label">ID Number or Passport Number *</label>
              <input type="text" class="form-control" placeholder="ID number or Passport Number" id="idNumber" required/>
            </div>
            <div class="col-md-12 mb-3">
              <label for="dob" class="form-label">Date of Birth *</label>
              <input type="date" class="form-control" id="dob" required/>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Student Specific Fields (hidden by default) -->
    <div id="studentFields" class="form-section hidden mb-4 profile-card p-4 rounded">
      <!-- Country Information -->
      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="coCitizenship" class="form-label">Country of Citizenship *</label>
          <input type="text" class="form-control" placeholder="Country of citizenship" id="coCitizenship" required/>
        </div>
        <div class="col-md-4 mb-3">
          <label for="coBirth" class="form-label">Country of Birth *</label>
          <input type="text" class="form-control" placeholder="Country of birth" id="coBirth" required/>
        </div>
        <div class="col-md-4 mb-3">
          <label for="coResidence" class="form-label">Country of Residence *</label>
          <input type="text" class="form-control" placeholder="Country of residence" id="coResidence" required/>
        </div>
      </div>
      <!-- Email & Contact Information -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="studentEmail" class="form-label">Student Email *</label>
          <input type="email" class="form-control" placeholder="Student email" id="studentEmail" required/>
        </div>
        <div class="col-md-6 mb-3">
          <label for="cNumber" class="form-label">Contact Number *</label>
          <input type="tel" class="form-control" placeholder="Contact number" id="cNumber" pattern="[0-9]{10,15}" required/>
        </div>
      </div>
      <!-- Password Fields -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="password" class="form-label">Password *</label>
          <input type="password" class="form-control" placeholder="Password" id="password" minlength="6" required/>
        </div>
        <div class="col-md-6 mb-3">
          <label for="cPassword" class="form-label">Confirm Password *</label>
          <input type="password" class="form-control" placeholder="Confirm password" id="cPassword" required/>
        </div>
      </div>
    </div>

    <!-- Funder Specific Fields (hidden by default) -->
    <div id="funderFields" class="form-section hidden mb-4 profile-card p-4 rounded">
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="email" class="form-label">Email *</label>
          <input type="email" class="form-control" placeholder="Email" id="email" required/>
        </div>
        <div class="col-md-6 mb-3">
          <label for="cNumber" class="form-label">Contact Number *</label>
          <input type="tel" class="form-control" placeholder="Contact number" id="cNumber" pattern="[0-9]{10,15}" required/>
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-md-6 mb-3">
          <label for="password" class="form-label">Password *</label>
          <input type="password" class="form-control" placeholder="Password" id="password" minlength="6" required/>
        </div>
        <div class="col-md-6 mb-3">
          <label for="cPassword" class="form-label">Confirm Password *</label>
          <input type="password" class="form-control" placeholder="Confirm password" id="cPassword" required/>
        </div>
      </div>
    </div>

    <!-- Submit Section with Terms and Login Link -->
    <div class="text-center mt-5">
      <!-- Terms and conditions notice -->
      <h6 class="text-muted fw-light small">
        By continuing, <br> you agree to our 
        <a href="terms.html" class="text-decoration-underline fw-bold" style="color: #468FAF;">Terms & Conditions</a> and 
        <a href="privacy.html" class="text-decoration-underline fw-bold" style="color: #468FAF;">Privacy Policy</a>.
      </h6>

      <!-- Submit button -->
      <div class="text-center mt-2">
        <button type="submit" class="btn btn-submit-sign-up mt-2 px-4">Submit</button>
      </div>

      <!-- Login redirect for existing users -->
      <h6 class="mt-3 fw-regular">
        Already have an account? 
        <a href="login.html" class="text-decoration-underline fw-bold" style="color: #468FAF;">Login</a>
      </h6>
    </div>
  </div>
</div>

<!-- JavaScript to handle user type toggle functionality -->
<script>
// Wait for DOM to be fully loaded before executing script
document.addEventListener("DOMContentLoaded", () => {
  // Get DOM elements for toggle functionality
  const studentOption = document.querySelector(".toggle-option.student");
  const funderOption = document.querySelector(".toggle-option.funder");
  const indicator = document.getElementById("toggleIndicator");
  const userTypeInput = document.getElementById("userType");
  const signupFormSections = document.getElementById("signupFormSections");
  const studentFields = document.getElementById("studentFields");
  const funderFields = document.getElementById("funderFields");

  // Function to handle user type selection
  const selectUserType = (type) => {
    // Store selected user type in hidden input
    userTypeInput.value = type;

    // Show form container when user type is selected
    signupFormSections.classList.remove("hidden");

    // Show/hide appropriate form fields based on user type
    studentFields.classList.toggle("hidden", type !== "student");
    funderFields.classList.toggle("hidden", type !== "funder");

    // Update active state styling for toggle options
    studentOption.classList.toggle("active", type === "student");
    funderOption.classList.toggle("active", type === "funder");

    // Move toggle indicator to selected position
    indicator.style.left = type === "student" ? "2px" : "110px";
  };

  // Attach click event handlers to toggle options
  studentOption.addEventListener("click", () => selectUserType("student"));
  funderOption.addEventListener("click", () => selectUserType("funder"));
});
</script>

<!-- Firebase authentication and user creation script -->
<script type="module">
// Import Firebase modules
import { auth, db } from './firebase-config.js';
import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { setDoc, doc } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

// Track selected user type from toggle (default to student)
let selectedUserType = 'student';
// Global function to set user type (called from toggle)
window.selectUserType = (type) => {
  selectedUserType = type;
  document.getElementById("userType").value = type;

  // Show/hide appropriate form sections
  document.getElementById("studentFields").classList.toggle("hidden", type !== "student");
  document.getElementById("funderFields").classList.toggle("hidden", type !== "funder");
};

// Handle form submission
const signupForm = document.querySelector("form");

signupForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  // Collect form fields based on user type
  const email = document.getElementById(selectedUserType === "student" ? "studentEmail" : "email").value;
  const password = document.getElementById("password").value;
  const confirmPassword = document.getElementById("cPassword").value;

  // Validate password match
  if (password !== confirmPassword) {
    alert("Passwords do not match.");
    return;
  }

  try {
    // Create Firebase Auth user account
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    const user = userCredential.user;

    // Prepare user data for Firestore
    const userData = {
      uid: user.uid,
      email: email,
      role: selectedUserType,
      firstName: document.getElementById("firstName")?.value || "",
      surName: document.getElementById("surName")?.value || "",
      idNumber: document.getElementById("idNumber")?.value || "",
      dob: document.getElementById("dob")?.value || "",
      coCitizenship: document.getElementById("coCitizenship")?.value || "",
      coBirth: document.getElementById("coBirth")?.value || "",
      coResidence: document.getElementById("coResidence")?.value || "",
      cNumber: document.getElementById("cNumber")?.value || "",
      race: document.getElementById("race")?.value || "",
      gender: document.getElementById("gender")?.value || "",
      matric: document.getElementById("matric")?.value || "",
      currently: document.getElementById("currently")?.value || "",
      orgInd: document.getElementById("org-ind")?.value || "",
      organization: document.getElementById("organization")?.value || "",
      createdAt: new Date()
    };

    // Save user data in Firestore database
    await setDoc(doc(db, "users", user.uid), userData);

    // Success message and redirect
    alert("Sign-up successful!");
    window.location.href = "login.html"; // redirect to login after successful signup
  } catch (error) {
    console.error(error);
    alert("Sign-up failed: " + error.message);
  }
});
</script>


<!-- Footer Section -->
<footer class="footer pt-5">

  <!-- Main container for footer content -->
  <div class="container pb-4">
    
    <div class="row">
      
      <!-- Newsletter Signup Column -->
      <div class="col-md-6 mb-4">
        <h5 class="fw-bold">Stay Connected</h5>
        <p class="mb-3">Sign up for our newsletter to stay informed.</p>
        <!-- Newsletter subscription form -->
        <form class="d-flex icon-input-group">
          <!-- Envelope icon inside input field -->
          <i class="fa-regular fa-envelope"></i>
          <!-- Email input field -->
          <input type="email" class="form-control me-2 rounded-3" placeholder="Enter email . . .">
          <!-- Submit button -->
          <button type="submit" class="btn btn-outline-primary px-3 sign-up-btn">SIGN UP</button>
        </form>
      </div>

      <!-- Social Media Column -->
      <div class="col-md-6 mb-4 text-md-end">
        <h5 class="fw-bold follow-us">Follow us</h5>
        <div class="social-icons mt-2">
          <!-- Instagram social media link -->
          <a href="https://www.instagram.com/thisisrichfield/?hl=en" target="_blank" rel="noopener noreferrer" class="text-decoration-none">
            <i class="fab fa-instagram"></i>
          </a>
          <!-- Facebook social media link -->
          <a href="https://www.facebook.com/thisisrichfield/" target="_blank" rel="noopener noreferrer" class="text-decoration-none">
            <i class="fab fa-facebook"></i>
          </a>
          <!-- LinkedIn social media link -->
          <a href="https://www.linkedin.com/school/richfieldeducation/posts/?feedView=all" target="_blank" rel="noopener noreferrer" class="text-decoration-none">
            <i class="fab fa-linkedin"></i>
          </a>
        </div>
      </div>

    </div>

    <hr> <!-- Horizontal separator line -->

    <div class="row text-start text-md-start">

      <!-- Navigate Links Column -->
      <div class="col-6 col-md-3 mb-4">
        <h6 class="fw-bold">Navigate</h6>
        <ul class="list-unstyled">
          <li><a href="index.html">Home</a></li>
          <li><a href="donate.html">Donate</a></li>
          <li><a href="story.html">Stories</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
      </div>

      <!-- Company Links Column -->
      <div class="col-6 col-md-3 mb-4">
        <h6 class="fw-bold">Company</h6>
        <ul class="list-unstyled">
          <li><a href="contact.html">Contact us</a></li>
          <li><a href="faq.html">FAQ's</a></li>
        </ul>
      </div>

      <!-- Contact Info Column -->
      <div class="col-md-6 mb-4">
        <h6 class="fw-bold">Contact</h6>
        <!-- Address with clickable Google Maps link -->
        <p class="mb-1">
          <a href="https://www.google.com/maps/place/Richfield+Cape+Town+Campus/@-33.9229995,18.4134391,17z/data=!3m1!4b1!4m6!3m5!1s0x1dcc6763f48a57fd:0x167125f9a04d06ff!8m2!3d-33.923004!4d18.41831!16s%2Fg%2F1hhh2yjf_?entry=ttu&g_ep=EgoyMDI1MTAyMi4wIKXMDSoASAFQAw%3D%3D" target="_blank">
            5th floor 112 Long St <br> 
            Cape Town <br> 
            8000 <br> 
            Western Cape
          </a>
        </p>
        <!-- Phone number link -->
        <p class="mb-1"><a href="tel:+27218310700">+27 21 831 0700</a></p>
        <!-- Email link -->
        <p class="mb-0"><a href="mailto:fundmyfuture@gmail.com">fundmyfuture@gmail.com</a></p>
      </div>

    </div>
  </div> <!-- End container -->

  <!-- Footer Bottom Bar -->
  <div class="footer-bottom py-3">
    <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
      
      <!-- Legal & policy links section -->
      <div class="mb-2 mb-md-0">
        <a href="terms.html" class="me-3 text-white">Terms & Conditions</a>
        <a href="privacy.html" class="me-3 text-white">Privacy Policy</a>
        <a href="cookies.html" class="me-3 text-white">Cookies Policy</a>
        <a href="cookies_settings.html" class="text-white">Cookies Settings</a>
      </div>

      <!-- Copyright information -->
      <div class="text-white">&copy;2025 FundMyFuture</div>
    </div>
  </div>

</footer>

<!-- Bootstrap + Font Awesome JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>